var inner_scheduler = require('node-schedule');
var relay = require('pecan-relay');

var scheduler = {
  init: function (config) {
    config.forEach(function(sch){
      
      // on     
      inner_scheduler.scheduleJob({
          hour: sch.on.hour,
          minute: sch.on.minute
        }, function(){
          relay.set(sch.id, true);    
        });

      // off
      inner_scheduler.scheduleJob({
          hour: sch.off.hour,
          minute: sch.off.minute
        }, function(){
          relay.set(sch.id, false);    
        });

    });
  }
};

module.exports = scheduler;